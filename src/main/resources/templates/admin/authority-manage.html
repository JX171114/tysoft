<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="UTF-8"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
	<meta http-equiv="Expires" CONTENT="0"/>
	<meta http-equiv="Cache-Control" CONTENT="no-cache"/>
	<meta http-equiv="Pragma" CONTENT="no-cache"/>
	<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport"/>
	<title>菜单权限管理</title>
	<link rel="stylesheet" th:href="@{/static/bootstrap/css/bootstrap.min.css}"/>
	<link rel="stylesheet" th:href="@{/static/dist/css/font-awesome.min.css}"/>
	<link rel="stylesheet" th:href="@{/static/dist/css/ionicons.min.css}"/>
	<link rel="stylesheet" th:href="@{/static/css/common.css}"/>
	<style type="text/css">
		html,body {overflow-x:hidden;height:100%;}
		.container{margin-top:5px;}
		.navbar{padding: 0 10px;}
		.bar_left {
		    float: left;
		    line-height: 49px;
		}
		.bar_right {
		    float: right;
		    line-height: 49px;
		}
		.page_title {
		    width: 50%;
		    position: absolute;
		    left: 25%;
		    font-weight: 400;
		    text-align: center;
		    color: #232528;
		    font-size: 18px;
		    overflow: hidden;
		    white-space: nowrap;
		    text-overflow: ellipsis;
		    margin-top:none;
		}
		.app_box_item {
		    position: relative;
		}
		.app_box {
		    margin: 20px;
		    padding: 0;
		    overflow: hidden;
		}
		.app_box li {
			list-style:none;
		    position: relative;
		    float: left;
		    margin-right: 0;
		    margin-left: 0;
		    margin-bottom: 10px;
		    width: 104px;
		    text-align: center;
		    padding: 20px 6px 20px;
		}
		.logo_img {
		    padding-top: 5px;
		    height: 70px;
		    width: 70px;
		    display: inline-block;
		    position: relative;
		    -webkit-border-radius: 10%;
		    -moz-border-radius: 10%;
		    border-radius: 10%;
		    -webkit-background-clip: padding-box;
		    -moz-background-clip: padding-box;
		    background-clip: padding-box;
		}
		.border_alpha {
			
		    border: 1px solid #eee;
		    border-color: rgba(0,0,0,.1);
		    -moz-background-clip: padding;
		    -webkit-background-clip: padding;
		    background-clip: padding-box;
		}
		.name {
			margin-bottom: 2px;
		    width: 100px;
		    text-align: center;
		    font-size: 14px;
		    font-weight: 400;
		    overflow: hidden;
		    text-overflow: ellipsis;
		    white-space: nowrap;
		}
		.my-menu-header{
			cursor: move;
		    background-color: #f3f3f3;
		    width: 70px;
		    margin: 0 auto;
		    font-size: 8px;
		}
	</style>
</head>
<body>
	<div id="container" style="width:100%" class="container">
		<div class="row clearfix">
			<div class="col-md-12 column">
				<div class="app_box_item">
					<ol class="breadcrumb">
					  <li><button type="button" class="btn btn-default btn-link" onclick="goAddMainAuth()">新建主菜单</button></li>
					</ol>
				</div>
				<ul class="app_box">
					<li th:each="auth:${auths}" th:attr="id=${auth.id}">
						<div class="my-menu-header handle">
							<span><i class="fa fa-ellipsis-v"></i> 拖动排序</span>
						</div>
						<a class="logo_img border_alpha" th:href="@{/authority/input.html?authId=}+${auth.id}">
							<i th:class="${auth.icon}" style="font-size:60px;"></i>
						</a>
						<h3 class="name" th:text="${auth.name}"></h3>
					</li>
				</ul>
			</div>
		</div>
	</div>
</body>
<script type="text/javascript" th:src="@{/static/plugins/jQuery/jquery-2.2.3.min.js}"></script>
<!-- jQuery UI 1.11.4 -->
<script type="text/javascript" th:src="@{/static/plugins/jQueryUI/jquery-ui.min.js}"></script>
<script type="text/javascript" th:src="@{/static/bootstrap/js/bootstrap.min.js}"></script>
<script type="text/javascript" th:src="@{/static/js/common.js}"></script>
<script type="text/javascript" th:inline="javascript">
/*<![CDATA[*/
	var CTX = [[@{/}]];
	
	$(function(){
		$(".app_box").sortable({
		    handle: ".handle",
		    opacity: 0.6, //拖动时，透明度为0.6
		    forcePlaceholderSize: true,
		    zIndex: 999999,
		    update : function(event, ui){
		    	var items = $(this).sortable("toArray");
		    	$.ajax({
		    		url: CTX+'authority/save-auth-sort',
		    		type:'POST',
		    		dataType:'text',
		    		traditional:true,
		    		data:{authIds:items},
		    		success:function(text){
		    			if(text=='error'){
		    				alert('保存出错');
		    			}
		    		},
		    		error:function(){
		    			alert('请求超时或系统出错');
		    		}
		    	});
    		}
	  	});
	});
	function goAddMainAuth(){
		window.location.href = CTX+'authority/input.html';
	}
	
/*]]>*/		
</script>
</html>