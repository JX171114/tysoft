<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<!--
* @Copyright(c): 厦门路桥信息股份有限公司  版权所有
* @author :XMRBI
* @Description:合同修改界面
* @createDate:2018-8-13
-->
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta
	content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
	name="viewport" />
<title>合同修改界面</title>
<link rel="stylesheet"
	th:href="@{/static/bootstrap/css/bootstrap.min.css}" />
<link rel="stylesheet"
	th:href="@{/static/dist/css/font-awesome.min.css}" />
<link rel="stylesheet" th:href="@{/static/dist/css/ionicons.min.css}" />
<link rel="stylesheet" th:href="@{/static/css/common.css}" />
<link rel="stylesheet" th:href="@{/static/plugins/select2/select2.css}" />
<link rel="stylesheet"
	th:href="@{/static/plugins/bootstrap-treeview/bootstrap-treeview.min.css}" />
<link rel="stylesheet"
	th:href="@{/static/plugins/bootstrap-toggle/bootstrap-toggle.min.css}" />
<link rel="stylesheet"
	th:href="@{/static/plugins/bootstrap-validator/css/bootstrapValidator.min.css}" />
<link rel="stylesheet" th:href="@{/static/dist/css/AdminLTE.css}" />
<link rel="stylesheet"
	th:href="@{/static/dist/css/skins/_all-skins.min.css}" />
<link rel="stylesheet"
	th:href="@{/static/dist/css/font-awesome.min.css}" />
<link rel="stylesheet" th:href="@{/static/dist/css/ionicons.min.css}" />
<link rel="stylesheet"
	th:href="@{/static/plugins/jvectormap/jquery-jvectormap-1.2.2.css}" />
<!-- Theme style -->
<link rel="stylesheet" th:href="@{/static/dist/css/AdminLTE.min.css}" />
<link rel="stylesheet"
	th:href="@{/static/dist/css/skins/_all-skins.min.css}" />
<link rel="stylesheet" th:href="@{/static/css/common.css}" />
<!-- Bootstrap 3.3.7 -->
<link rel="stylesheet"
	th:href="@{/static/bootstrap/css/bootstrap.min.css}" />
<link rel="stylesheet"
	th:href="@{/static/plugins/bootstrap-table/dist/bootstrap-table.min.css}" />
<style type="text/css">
.panel {
	margin-bottom: 0px;
}

.form-group {
	margin-bottom: 2px;
}
</style>
<style type="text/css">
html, body {
	overflow-x: hidden;
}

body {
	padding-top: 5px;
}

.box.box-solid.box-default>.box-header {
	background-color: #DEF2FF;
}

.col-sm-10 span {
	word-break: break-all;
	word-wrap: break-word;
	white-space: normal;
	display: block;
	float: left;
	height: 34px;
	padding: 6px 12px 6px 0px;
	font-size: 14px;
	line-height: 1.42857143;
	color: #777;
}

#contractAnnexs>thead>tr>th {
	text-align: center;
	vertical-align: middle !important;
	vertical-align: middle !important;
}

#contractAnnexs>tbody>tr>td {
	text-align: center;
	vertical-align: middle !important;
	vertical-align: middle !important;
}

#compList>thead>tr>th {
	text-align: center;
	vertical-align: middle !important;
}

#compList>tbody>tr>td {
	vertical-align: middle !important;
}

#annexList>thead>tr>th {
	text-align: center;
	vertical-align: middle !important;
	vertical-align: middle !important;
}

#annexList>tbody>tr>td {
	text-align: center;
	vertical-align: middle !important;
	vertical-align: middle !important;
}

#btn_upload, #btn_delete {
	padding: 3px 6px;
	font-size: 12px;
}

input {
	text-align: left;
}

.table>tbody>tr>td {
	padding: 3px;
}
</style>
</head>
<body>
     <!-- 跳转表单-->
     <form action="" method="get" id="closeContractFrom"></form>
	<div class="container-fluid" style="width: 100%; height: 100%">
		<div class="row">
			<div class="col-md-12">
				<ul id="myTab" class="nav nav-tabs">
					<li class="active"><a href="#basicInfo" data-toggle="tab">基本信息</a>
					</li>
					
					<li><a href="#contractText" data-toggle="tab" onclick="loseFocus()"><span></span>合同正文</a>
					</li>
					
					<li><a href="#contractMain" data-toggle="tab" onclick="loseFocus()"><span></span>合同摘要表</a>
					</li>
					
				</ul>
			</div>
		</div>

		<div id="myTabContent" class="tab-content">
		
		<div  class="tab-pane fade" id="contractMain">
			<div class="box box-default collapsed-box box-solid" style="margin: 5px 0px;border-color: #DEF2FF;">
                <div class="box-header with-border" style="padding: 8px;">
                    <span style="font-weight: bold;font-size: 14px;">合同摘要</span>
                    <form id="formAnnex" class="form-horizontal">

                    </form>
                </div>
            </div>
			
			<table id="contractMainList" class="table table-bordered" style="width: 100%">
			   	<thead>
			   		<tr align="center">
			   		</tr>
			   	</thead>
			   	<tbody id="contractMainList_body">
			   		<tr>
						<td align="left"
						style="vertical-align: middle; width: 10%; height: 40px; text-align: center;">
						<span th:text="合同名称"></span>
						</td>
						<td  style="vertical-align: middle; text-align: center;" >
						<span id="spanContractName"></span>
						</td>
						  
						<td align="left"
						style="vertical-align: middle; width: 10%; height: 40px; text-align: center;">
						<span th:text="合同编号"></span>
						</td>
						<td style="vertical-align: middle;width: 40%;  text-align: center;" >
						<span id="spanContractNumber"></span>
						</td>
					</tr>
					
					  <tr>
						<td align="left"
						style="vertical-align: middle; width: 10%; height: 40px; text-align: center;">
						<span th:text="经办部门"></span>
						</td>
						<td style="vertical-align: middle;width: 40%;  text-align: center;" >
						   <span id="spanContractOwnerDept"></span>
						</td>
						
						<td align="left"
						style="vertical-align: middle; width: 10%; height: 40px; text-align: center;">
						<span th:text="经办人"></span>
						</td>
						
						<td style="vertical-align: middle;width: 40%;  text-align: center;" >
						<span id="spanContractOwner"></span>
						</td>
					</tr>
					
						<tr>
						<td align="left"
						style="vertical-align: middle; width: 10%; height: 40px; text-align: center;">
						<span th:text="合同签约方"></span>
						</td>
						<td style="vertical-align: middle;width: 40%;  text-align: center;" >
						  <span id="spanSignContractPeople"></span>
						</td>
						
						<td align="left"
						style="vertical-align: middle; width: 10%; height: 40px; text-align: center;">
						<span th:text="合同金额"></span>
						</td>
						<td style="vertical-align: middle;width: 40%;  text-align: center;"  >
						     <span id="spanContractMoney"></span>
						</td>
					    </tr>
					
						<tr>
						<td align="left"
						style="vertical-align: middle; width: 10%; height: 40px; text-align: center;">
						<span th:text="合同确定方式"></span>
						</td>
						<td  align="center"  style="vertical-align: middle;width: 40%;  text-align: center;" >
						
						<span id="spanContractConfirmWay" ></span>
						</td>
					    <td></td>
					    <td></td>
					    </tr>
					    
					    <tr>
						<td align="left"
						style="vertical-align: middle; width: 10%; height: 40px; text-align: center;">
						<span th:text="主要签订依据"></span>
						</td>
						<td style="vertical-align: middle;width: 40%;  text-align: center;" >
						   <span id="spanContractSigningBasis" ></span>
						</td>
					    <td></td>
					    <td></td>
					    </tr>
					    
					    <tr>
						<td align="left"
						style="vertical-align: middle; width: 10%; height: 40px; text-align: center;">
						<span th:text="合同签订主要事宜"></span>
						</td>
						
						<td style="vertical-align: middle;width: 40%;  text-align: center;" >
						<span id="spanContractMainThing" ></span>
						</td>
					    <td></td>
					    <td></td>
					    </tr>
				
			   	</tbody>
			 </table>
		</div>
		
		
		<div  class="tab-pane fade" id="contractText">
		 <div class="box box-default collapsed-box box-solid" style="margin: 5px 0px;border-color: #DEF2FF;">
                <div class="box-header with-border" style="padding: 8px;">
                    <span style="font-weight: bold;font-size: 14px;">合同列表</span>
                    <form id="formAnnex" class="form-horizontal">
                    </form>
                </div>
             </div>
                 
				<div id="btn_div" class=""  style="margin-bottom: 5px;margin-left: 16px;">
			     <button id="btn_upload" type="button" class="btn btn-primary" th:onclick="'fnUploadContractAnnex('+${anndexFolderId}+',\''+${anndexFolderName}+'\')'">
			        <span class="glyphicon glyphicon-upload" aria-hidden="true" style="color: #18A689"></span>上传正文
			     </button>
			     &nbsp;
	           <table id="contractAnnexs" class="table table-bordered" style="width: 100%">
			   	<thead>
			   		<tr align="center">
			   			<th>序号</th>
			   			<th>合同名称</th>
			   			<th>操作</th>
			   		</tr>
			   	</thead>
			  <tbody id="contractAnnexList_body">
			   		<tr th:if="${#lists.isEmpty(contractAnnexs)}" height="32px;">
						<td colspan="5" align="center">
						无</td>
						
					</tr>
					<tr th:each="annex,annexStat : ${contractAnnexs}">
						<td align="center" style="text-align: center;">
							<input hidden="hidden" name="fieldIds" th:value="${annex.id}"/>
							<span th:text="${annexStat.index+1}"></span>
						</td>
						<td align="center" style="text-align: center;">
							<a href="javascript:" th:onclick="'window.top.openCommonViewImgWin(\''+${annex.id}+'\')'" th:text="${annex.name}+${'.'}+${annex.extendName}"></a>
						</td>
						<td align="center" style="text-align: center;">
							<a href="javascript:" th:onclick="'fnDeleteContractAnnex(this,\''+${annex.id}+'\')'" th:if="${#strings.isEmpty(readonly)}">
								<span class="glyphicon glyphicon-remove" aria-hidden="true" style="color: red;" title="删除"></span>
							</a>
						</td>
					</tr>
			   	</tbody>
			 </table>
		</div>
	 </div>
		
		
			<div class="tab-pane fade in active" id="basicInfo">
			<h3 align="center" th:if="${ContractEnter.contractType}==0" th:text="厦门轨道物资有限公司钢材赊销、围挡、钢支撑、机电合同单" style="margin: 10px 0px;"></h3>	
				<h3 align="center" th:if="${ContractEnter.contractType}==1" th:text="厦门轨道物资有限公司甲供三方合同单" style="margin: 10px 0px;"></h3>	
				<h3 align="center" th:if="${ContractEnter.contractType}==2" th:text="厦门轨道物资有限公司地铁甲供物资采购合同单" style="margin: 10px 0px;"></h3>	
				<h3 align="center" th:if="${ContractEnter.contractType}==3" th:text="厦门轨道物资有限公司办公室专用合同单" style="margin: 10px 0px;"></h3>	
			    <h3 align="center" th:if="${ContractEnter.contractType}==4" th:text="厦门轨道物资有限公司财务部、贸管部通用合同单" style="margin: 10px 0px;"></h3>	
				<form id="myform_contract" class="form-horizontal">
					<input hidden="hidden" name="id" th:value="${ContractEnter.contractType}" />
				</form>
		   <!--设置表单保存合同数据 -->
			<form action="" method="post" id="contractListFrom">
			
			<!-- 签约方类型，合同状态，合同创建时间 ，创建人（合同经办方），创建人id（合同经办方的id），签约方类型，附件     （后台处理）-->
			<input type="hidden" name="id" th:value="${ContractEnter.id}"/>
			<input type="hidden" name="contractCreatTime" th:value="${ContractEnter.contractCreatTime}"/>
			<input type="hidden" name="contractType" th:value="${ContractEnter.contractType}"/>
			<input type="hidden"  id="contractId" th:value="${ContractEnter.id}" />
			<input type="hidden"  name="getAnnexIds" id="getAnnexIds"/>
			<input type="hidden"  name="contractName"  value=""/>
			<input type="hidden"  name="project_Name" value=""/>
			<input type="hidden"  name="projectId"  value=""/>
			<input type="hidden"  name="contractConfirmWay"  value=""/>
			<input type="hidden"  name="contractMatter" value=""/>
            <input type="hidden"  name="contractMoney" value=""/>
            <input type="hidden"  name="signContractPeople" value=""/>
             <input type="hidden"  name="contractPartyType" value=""/>
            <input type="hidden"  name="legalAuditorId"  value=""/>		
            <input type="hidden"  name="legalAuditor" value=""/>
            <input type="hidden"  name="accoutingAuditorId"  value=""/>		
            <input type="hidden"  name="accoutingAuditor" value="" />		
            <input type="hidden"  name="isLeaderApproval"  value=""/>
            <input type="hidden"  name="isStamp"  value=""/>
            <input type="hidden"  name="theOtherParty"  value=""/>	
            <input type="hidden"  name="theOtherPartyPhone" value="" />	
            <input type="hidden"  name="contractNumber" value="" />
            <input type="hidden"  name="contractOwner"  value=""/>	
            <input type="hidden"  name="contractOwnerPhone" value="" />	
            <input type="hidden"  name="contractOwnerDept" value=""/>
            <input type="hidden"  name="contractSigningBasis"  value=""/>	
            <input type="hidden"  name="contractMainThing" value="" />	
            <input type="hidden"  name="contractTextNumber"  value=""/>	
            <input type="hidden"  name="ownContractTextNumber"  value=""/>	
            <input type="hidden"  name="otherContractTextNumber"  value=""/>	
            <input type="hidden"  name="isPromise"  value=""/>
            <input type="hidden"  name="annexIds" value=""/>	
            <input type="hidden"  name="contractTextAnnexId" id="contractTextAnnexId" th:value="${contractTextAnnexId}"/>	
            <input type="hidden"  id="stateContract"  name="stateContract" value=""/>
            <input type="hidden"  name="contractCreatPeople" th:value="${ContractEnter.contractCreatPeople}" th:if="${ContractEnter.contractCreatPeople}!=null"/>
            <input type="hidden"  name="contractCreatPeopleId" th:value="${ContractEnter.contractCreatPeopleId}" th:if="${ContractEnter.contractCreatPeople}!=null"/>	
			</form>
				 <!--设置表单保存合同数据 -->
			<form action="" method="post" id="contractListFrom">
			<input type="hidden" id="idTest" th:value="${ContractEnter.id}"/>
			
				<table id="contractList" class="table table-bordered"
					style="width: 100%">
					<thead>
						<tr align="center"></tr>
					</thead>
					<tbody id="contractList_body">
						<!-- 合同名称 -->
						<tr>
							<td align="left"
								style="vertical-align: middle; width: 120px; height: 40px; text-align: center;">
								<span th:text="合同名称："></span>
							</td>

							<td colspan="3" align="left" style="height: 40px;"><input
								type="text" id="contractName" name="contractName"
								class="form-control"  onblur=" loseFocus()" th:value="${ContractEnter.contractName}" /></td>
						</tr>
						<!-- 项目名称： -->
						<tr>
							<td align="left"
								style="vertical-align: middle; height: 40px; width: 120px; text-align: center; height: 20px">
								<span th:text="项目名称："></span>
							</td>

							<td colspan="3" align="left" style="height: 40px;">
								<div>
									<div style="float: left ;width: 94%;">
										<input type="text" id="project_Name" name="project_Name"
											class="form-control" th:value="${ContractEnter.projectName}"
											disabled="disabled" />
										<input type="hidden" id="projectId" name="projectId"  th:value="${ContractEnter.projectId}"/>
									</div>
									<div style="float: left">
										&nbsp; <a href="javascript:void(0)"> <span
											class="glyphicon glyphicon-pencil" aria-hidden="true"
											style="color: black; vertical-align: middle; width: 10px; height: 6px"
											onclick="openModel(1)"></span></a>&nbsp;&nbsp;&nbsp; <a
											href="javascript:void(0)"> <span
											class="glyphicon glyphicon-remove" aria-hidden="true"
											style="color: red; vertical-align: middle; width: 10px; height: 6px"
											onclick="delContractData(1)"></span></a>
									</div>
								</div>
							</td>
						</tr>
						<!-- 合同确定方式 合同金额 -->
						<tr>
							<td align="left"
								style="vertical-align: middle; height: 40px; text-align: center; width: 120px;">
								<span th:text="合同确定方式："></span>
							</td>

							<td colspan="3" align="left"
								style="vertical-align: middle; height: 40px; width: 120px;">
								<input type="radio" name="contract_ConfirmWay" value="公开招标" onclick="loseFocus()"/>公开招标
								&nbsp; <input type="radio" name="contractConfirmWay"
								value="诚邀招标" onclick="loseFocus()" />诚邀招标&nbsp; <input type="radio"
								name="contractConfirmWay" value="委托" onclick="loseFocus()" />委托 &nbsp; <input
								type="radio" name="contract_ConfirmWay" value="比选"  onclick="loseFocus()"/>比选 &nbsp; <input
								type="radio" name="contract_ConfirmWay" value="询价"  onclick="loseFocus()"/>询价 &nbsp; <input
								type="radio" name="contract_ConfirmWay" value="竞争性谈判" onclick="loseFocus()" />竞争性谈判
								&nbsp; <input type="radio" name="contract_ConfirmWay"
								value="单一来源采购" onclick="loseFocus()"/>单一来源采购 &nbsp; <input type="radio"
								name="contract_ConfirmWay" value="其他" onclick="loseFocus()"/>其他 &nbsp;
							    <input type="hidden" id="chooseConfirmWay" th:value="${ContractEnter.contractConfirmWay}"/>
							</td>
						</tr>
						<!--合同标的物-->
						<tr>
							<td align="left"
								style="vertical-align: middle; height: 40px; text-align: center; width: 120px;">
								<span th:text="合同标的物："></span>
							</td>
							<td><input type="text" id="contractMatter"
								name="contractMatter" class="form-control" style="width:100;" th:value="${ContractEnter.contractMatter}" />
							</td>

							<td align="left"
								style="vertical-align: middle; height: 40px; text-align: center; width:160px;">
								<span th:text="合同金额（元）："></span>
							</td>
							<td><input type="text" id="contractMoney"
								name="contractMoney" class="form-control" style="width: 100%;" th:value="${ContractEnter.contractMoney}" th:if="${ContractEnter.contractMoney}!=null"  onblur=" loseFocus()"/>
							
							<input type="text" id="contractMoney"
								name="contractMoney" class="form-control" style="width: 100%;"  th:if="${ContractEnter.contractMoney}==null"  onblur=" loseFocus()"/>
							
							</td>
						</tr>
						<!-- 合同签约方-->
						<tr>
							<td align="left"
								style="vertical-align: middle; height: 40px; width: 120px; text-align: center; height: 20px">
								<span th:text="合同签约方："></span>
							</td>

							<td colspan="3" align="left" style="height: 40px;">
								<div>
									<div style="float: left;width: 94%">
										<input type="text" id="sign_Contract_People" name="sign_Contract_People"
											class="form-control" 
											disabled="disabled" th:value="${signPeople}"/>
									</div>
									<div style="float: left">
										&nbsp; <a href="javascript:void(0)"> 
										<span class="glyphicon glyphicon-pencil" aria-hidden="true" onclick="openModel(2)" style="color: black; vertical-align: middle; width: 10px; height: 6px"></span>
										</a>
										&nbsp;&nbsp;&nbsp;
										 <a href="javascript:void(0)"> 
										 <span class="glyphicon glyphicon-remove" aria-hidden="true"
											 style="color: red; vertical-align: middle; width: 10px; height: 6px" onclick="delContractData(2)"></span></a>
									</div>
								</div>
							</td>
						</tr>
						
						<!--合同标的法务审核人 会计审核人 -->
						<tr>
							<td align="left"
								style="vertical-align: middle; height: 40px; text-align: center; width: 120px;">
								<span th:text="法务审核人："></span>
							</td>
							<td>
							<div style="float: left;width:85%">
							<input type="text" id="legalAuditor"
								  name="legalAuditor" class="form-control" disabled="disabled" th:value="${ContractEnter.legalAuditor}" />
						     <input type="hidden" id="legal_Auditor" th:value="${ContractEnter.legalAuditor}"/>
			                 <input type="hidden" id="legalAuditorId" name="legalAuditorId" th:value="${ContractEnter.legalAuditorId}"/>
							
							</div>
							
								<div style="float: left">
						          	&nbsp; <a href="javascript:void(0)"> 
										<span class="glyphicon glyphicon-pencil" aria-hidden="true" onclick="openModel(4)"
										 style="color: black; vertical-align: middle; width: 10px; height: 6px"></span>
										</a>
										&nbsp;&nbsp;&nbsp;
										 <a href="javascript:void(0)"> 
										 <span class="glyphicon glyphicon-remove" aria-hidden="true" onclick="delContractData(3)"
											 style="color: red; vertical-align: middle; width: 10px; height: 6px"></span></a>
							     </div>
							
							</td>

							<td align="left"
								style="vertical-align: middle; height: 40px; text-align: center; width: 160px;">
								<span th:text="会计审核人："></span>
							</td>
							<td>
							<div style="float: left;width:82%">
							<input type="text" id="accoutingAuditor" name="accoutingAuditor" class="form-control" disabled="disabled" th:value="${ContractEnter.accoutingAuditor}" />
							<input type="hidden" id="accouting_Auditor"  class="form-control" disabled="disabled" th:value="${ContractEnter.accoutingAuditor}" />
							<input type="hidden" id="accoutingAuditorId" name="accoutingAuditorId" th:value="${ContractEnter.accoutingAuditorId}"/>
							</div>
							<div style="float: left">
							&nbsp; <a href="javascript:void(0)"> 
										<span class="glyphicon glyphicon-pencil" aria-hidden="true" onclick="openModel(5)"
										 style="color: black; vertical-align: middle; width: 10px; height: 6px"></span>
										</a>
										&nbsp;&nbsp;&nbsp;
										 <a href="javascript:void(0)"> 
										 <span class="glyphicon glyphicon-remove" aria-hidden="true"  onclick="delContractData(4)"
											 style="color: red; vertical-align: middle; width: 10px; height: 6px"></span></a>
							     </div>
							</td>
						</tr>
						
						<!--是否要分管领导签字 是否需要公司盖章 -->
						<tr>
							<td align="left"
								style="vertical-align: middle; height: 40px; text-align: center; width: 120px;">
								<span th:text="是否需要集团分管领导审批："></span>
							</td>
							<td align="center" style="vertical-align: middle;">
							     <input type="radio" name="isLeader_Approval" value="0"/>是
							     &nbsp;&nbsp;&nbsp;&nbsp;
							     <input type="radio" name="isLeader_Approval" value="1"/>否
							     <input type="hidden" id="init_isLeader_Approval" th:value="${ContractEnter.isLeaderApproval}" th:if="${ContractEnter.isLeaderApproval}!=null"/>
								 <input type="hidden" id="init_isLeader_Approval" th:value="2" th:if="${ContractEnter.isLeaderApproval}!=null"/>
							
							
							</td>

							<td align="left"
								style="vertical-align: middle; height: 40px; text-align: center; width: 160px;">
								<span th:text="是否需要我司先盖章："></span>
							</td>
							
							<td align="center" style="vertical-align: middle;">
							     <input type="radio" name="is_Stamp" value="0"/>是
							     &nbsp;&nbsp;&nbsp;&nbsp;
							     <input type="radio" name="is_Stamp" value="1"/>否
							     <input type="hidden" id="init_is_Stamp" th:value="${ContractEnter.isStamp}" th:if="${ContractEnter.isStamp}!=null"/>
								 <input type="hidden" id="init_is_Stamp" th:value="2" th:if="${ContractEnter.isStamp}==null"/>
							
							</td>
						</tr>
						
						  <!--对方经办人电话 合同编号-->
                             <tr>
							<td align="left"
								style="vertical-align: middle; height: 40px; text-align: center; width: 120px;">
								<span th:text="对方经办人（电话）："></span>
							</td>
							
							<td>
							<div style="float: left;width: 49%"> 
							<input type="text" id="theOtherParty"
								  name="theOtherParty" class="form-control" style="height: 45px;" th:value="${ContractEnter.theOtherParty}" />
							</div>
							
							<div style="float:right;width: 49%"> 
							<input type="text" id="theOtherPartyPhone"
								  name="theOtherPartyPhone" class="form-control" style="height: 45px;" th:value="${ContractEnter.theOtherPartyPhone}" />
							</div>
							
							</td>

							<td align="left"
								style="vertical-align: middle; height: 40px; text-align: center; width: 160px;">
								<span th:text="合同编号："></span>
							</td>
							<td><input type="text" id="contractNumber"
								name="contractNumber" class="form-control" style="width: 100%;height: 45px;" onblur=" loseFocus()" th:value="${ContractEnter.contractNumber}" />
							</td>
						</tr>
						
						 <!--经办人电话 -->
                             <tr>
							<td align="left"
								style="vertical-align: middle; height: 40px; text-align: center; width: 120px;">
								<span th:text="合同经办人（电话）："></span>
							</td>
							
							<td>
							<div style="float: left;width: 49%"> 
							
							<input type="text" id="contractOwner"
								  name="contractOwner" class="form-control" th:value="${ContractEnter.contractOwner}"  disabled="disabled" style="height: 45px;" />
							</div>
							
							<div style="float:right;width: 49%"> 
							<input type="text" id="contractOwnerPhone"
								   name="contractOwnerPhone"  disabled="disabled" th:value="${ContractEnter.contractOwnerPhone}"  class="form-control" style="height: 45px;" />
							</div>
							
							</td>

							<td align="left"
								style="vertical-align: middle; height: 40px; text-align: center; width: 160px;">
								<span th:text="经办部门："></span>
							</td>
							
							<td><input type="text" id="contractOwnerDept"
								name="contractOwnerDept" class="form-control" disabled="disabled" th:value="${ContractEnter.contractOwnerDept}" style="width: 100%;height: 45px;" />
							</td>
						</tr>
						
						<!--合同签订依据-->
							<tr>
							<td align="left"
								style="vertical-align: middle; width: 120px; height: 60px; text-align: center;">
								<span th:text="合同签订依据："></span>
							</td>

							<td colspan="3" align="left" style="height: 40px;"><input
								type="text" id="contractSigningBasis" name="contractSigningBasis"  onblur=" loseFocus()" th:value="${ContractEnter.contractSigningBasis}"
								class="form-control" style="height: 60px;"  /></td>
						</tr>
						
						
						<!--合同主要事宜-->
							<tr>
							
							<td align="left"
								style="vertical-align: middle; width: 120px; height: 60px; text-align: center;">
								<span th:text="合同主要事宜："></span>
							</td>

							<td colspan="3" align="left" style="height: 40px;"><input 
								type="text" id="contractMainThing" name="contractMainThing"  onblur=" loseFocus()"  th:value="${ContractEnter.contractMainThing}"
								class="form-control" style="height: 60px;"  /></td>
						   </tr>
						   
						   	<!-- 合同份数 -->
						<tr>
							<td align="left"
								style="vertical-align: middle; width: 120px; height: 40px; text-align: center;">
								<span th:text="合同份数："></span>
							</td>

							<td colspan="3" align="left" style="height: 40px;">
							<div style="float: left;text-align: center;height:35px;line-height:35px; overflow:hidden">
							   合同一式：
							</div>
							
							<div style="float: left;width:4%;">
							<input type="text" id="contractTextNumber" name="contractTextNumber"  th:value="${ContractEnter.contractTextNumber}"
								class="form-control" />
							</div>
							
							<div style="float: left;text-align: center;height:35px;line-height:35px; overflow:hidden">
							  份，其中我方
							</div>
							
							<div style="float: left;width:4%;">
							<input type="text" id="ownContractTextNumber" name="ownContractTextNumber" th:value="${ContractEnter.ownContractTextNumber}"
								class="form-control"/>
							</div>
							
							<div style="float: left;text-align: center;height:35px;line-height:35px; overflow:hidden" >
							  份，其他方
							</div>
							
							<div style="float: left;width:4%;">
							<input type="text" id="otherContractTextNumber" name="otherContractTextNumber"  th:value="${ContractEnter.otherContractTextNumber}"
								class="form-control"/>
							</div>
							
							<div style="float: left;text-align: center;height:35px;line-height:35px; overflow:hidden">
							  份 
							</div>
							
							<div style="float: left;color:red; center;height:35px;line-height:35px; overflow:hidden">
							  (请输入数字)
							</div>
							</td>
						</tr>
						   
						   <!--我承诺-->
							<tr>
							<td align="left"
								style="vertical-align: middle; width: 120px; height: 40px; text-align: center;">
								<input type="checkbox" id="isPromiseState" name="isPromiseState" checked="checked"/>
								<input type="hidden" name="isPromise"/>
								<span th:text="我承诺：" style="color: red;"></span>
							</td>

							<td colspan="3" align="left" style="height: 40px;">
							<div style="float: left;text-align: center;height:35px;line-height:35px; overflow:hidden">
							本人对本合同资信材料、签约方签字字样及印章真实性负责，如因此给公司造成损失愿承担赔偿责任。
							</div>
						    </td>
						</tr>
					</tbody>
				</table>
				</form>
				<br/>
				
				<!--附件表格-->
				
				<div class="box box-default collapsed-box box-solid" style="margin: 5px 0px;border-color: #DEF2FF;">
                <div class="box-header with-border" style="padding: 8px;">
                    <span style="font-weight: bold;font-size: 14px;">附件列表</span>
                    <form id="formAnnex" class="form-horizontal">
                    </form>
                </div>
                 </div>
                 
				<div id="btn_div" class=""  style="margin-bottom: 5px;margin-left: 16px;">
			     <button id="btn_upload" type="button" class="btn btn-primary" th:onclick="'fnUploadAnnex('+${anndexFolderId}+',\''+${anndexFolderName}+'\')'">
			        <span class="glyphicon glyphicon-upload" aria-hidden="true" style="color: #18A689"></span>上传附件
			     </button>
			     &nbsp;
			    <button id="btn_delete" type="button" class="btn btn-primary" onclick="fnDeleteAllAnnex()" >
			      <span class="glyphicon glyphicon-remove" aria-hidden="true" style="color: red;"></span>批量删除
			     </button>
			    </div> 
				<!--附件表格-->
				<table id="annexList" class="table table-bordered" style="width: 100%">
			   	<thead>
			   		<tr align="center">
			   			<th>序号</th>
			   			<th>附件名称</th>
			   			<th>创建人</th>
			   			<th>创建时间</th>
			   			<th>操作</th>
			   		</tr>
			   	</thead>
			 <tbody id="annexList_body">
			   		<tr th:if="${#lists.isEmpty(annexs)}" height="32px;">
						<td colspan="5" align="center">无</td>
					</tr>
					<tr th:each="annex,annexStat : ${annexs}">
						<td align="center">
							<input hidden="hidden" name="fieldIds" th:value="${annex.id}"/>
							<span th:text="${annexStat.index+1}"></span>
						</td>
						<td align="center">
							<a href="javascript:" th:onclick="'window.top.openCommonViewImgWin(\''+${annex.id}+'\')'" th:text="${annex.name}+${'.'}+${annex.extendName}"></a>
						</td>
						<td th:text="${annex.creator}" align="center"></td>
						<td th:text="${annex.uploadTime}?${#dates.format(annex.uploadTime, 'yyyy-MM-dd')}:''" align="center"></td>
						<td align="center">
							<a href="javascript:" th:onclick="'fnDeleteAnnex(this,\''+${annex.id}+'\')'" th:if="${#strings.isEmpty(readonly)}">
								<span class="glyphicon glyphicon-remove" aria-hidden="true" style="color: red;" title="删除"></span>
							</a>
						</td>
					</tr>
			   	</tbody> 
			 </table>
			 
			 <!--界面操作按钮-->
				 <div style="text-align: center;margin-bottom: 10px;">
				 <button type="button" onclick="fnSubmitReport(1)" class="btn btn-primary" style="margin-right: 25px;width: 80px;">修改</button>
			     <button type="button" id="contractSubmit" onclick="contractSubmit()" class="btn btn-primary" style="margin-right: 25px;width: 80px;">提交</button>
			     <button type="button"  class="btn btn-primary" onclick="fnClickReport()" style="width: 80px;">关闭</button> 
			     </div>
			</div>
		</div>
	</div>

	<!-- 增加合同的modal框 -->
	<div class="modal fade" id="openProjectModal" role="dialog"
		aria-labelledby="myModalLabel" data-backdrop="static"
		aria-hidden="true">
		<div class="container-fluid" role="document" style="width: 800px">
			<div class="modal-content">

				<div style="float: right;">
					<button type="button" class="close" data-dismiss="modal"
						style="color: white; background-color: red; width: 25px; height: 25px;">×</button>
				</div>
				
				<div class="modal-body" style="overflow: hidden; padding: 10px;">
					<div class="box box-default collapsed-box box-solid"
						style="margin-bottom: 5px; background: #DEF2FF; height: 38px;">
						<h4 id="modal_title" class="modal-title" style="color: blue;">项目信息</h4>
					</div>
				</div>
               
               
               <div class="box box-default collapsed-box box-solid" style="margin-bottom: 5px;border-color: #DEF2FF;">
				<div class="box-header with-border">
				<form id="formSearch" class="form-horizontal">
			        <div id="search_div" class="col-md-12">
		               
		                <div class="col-md-4" style="padding-right: 0px;">
	            			<div class="form-group">
			                  	<label class="col-sm-3 control-label search_div" style="width:  100px;">项目名称:</label>
			                  	<div class="col-sm-9 search_div" style="width: 150px;">
 	                            <input type="text" class="form-control" id="projectName" name="projectName" value=""  onkeyup="this.value=this.value.replace(/\s+/g,'')"/>			                  	</div>
			                </div>
	            		</div>
		                
		                <div class="col-md-4" style="padding: 0px;">
	            			<div class="form-group">
			                  	<label class="col-sm-3 control-label search_div" style="width: 100px;">项目编码:</label>
			                  	<div class="col-sm-4 search_div" style="width: 150px;">
			                  	<div class="input-group date">
                          	<input type="text" class="form-control" id="projectCode" name="projectCode" value=""  onkeyup="this.value=this.value.replace(/\s+/g,'')"/>				                  	</div>
			                  	</div>
			                </div>
	            		</div>
	            		
	            		
	            		<div class="col-md-4 btn-group" style="padding: 0px;">
					    	 <button id="btn_add" type="button" class="btn btn-default" onclick="queryInfo(1);">
					        	<span class="glyphicon glyphicon-search" aria-hidden="true" style="color: #18A689"></span>查询
					            </button>  	
					               <button id="btn_edit" type="button" class="btn btn-default" onclick="resetParams(1);">
					            <span class="glyphicon glyphicon-repeat" aria-hidden="true" style="color: #EC4758"></span>重置
					        </button>
	            		</div>
			        </div>
			    </form>
				</div>
			</div>
			
				<table id="dataList"></table>
				
				<div style="text-align: center;margin-bottom: 10px;">
				 <button type="button" onclick="suerChoose(1)" class="btn btn-primary" style="margin-right: 25px;width: 80px;">确定</button> 
				 <button type="button" onclick="fnCloseWin(1)" class="btn btn-primary" style="margin-right: 25px;width: 80px;">关闭</button>
			</div>
			</div>
		</div>
	</div>
	
	<!--签约方模态框 -->
	<div class="modal fade" id="openSupplierModal" role="dialog"
		aria-labelledby="myModalLabel" data-backdrop="static"
		aria-hidden="true">
		<div class="container-fluid" role="document" style="width: 500px">
			<div class="modal-content">

				<div style="float: right;">
					<button type="button" class="close" data-dismiss="modal"
						style="color: white; background-color: red; width: 25px; height: 25px;">×</button>
				</div>
				
				<div class="modal-body" style="overflow: hidden; padding: 10px;">
					<div class="box box-default collapsed-box box-solid"
						style="margin-bottom: 5px; background: #DEF2FF; height: 28px;">
						<h4 id="modal_title" class="modal-title" style="color: blue;">合约方信息</h4>
					</div>
				</div>
               
               <div class="box box-default collapsed-box box-solid" style="margin-bottom: 5px; border-color: #DEF2FF;">
				<div class="box-header with-border">
				<form id="formSearch" class="form-horizontal">
				<!--签约方名称-->
			        <div id="search_div" class="col-md-12">
		               	<div class="col-md-10" style="padding-right: 0px;">
							<div class="form-group">
								<label class="col-sm-3 control-label search_div"
									style="width: 120px;">签约方名称:</label>
								<div class="col-sm-9 search_div" style="width: 230px;">
									<input type="text" class="form-control" id="sign_contract_name"
										name="sign_contract_name" value="" style="width: 100%"/>
									<input type="hidden" id="init_sign_contract_people" th:value="${ContractEnter.signContractPeople}" />
								</div>
							</div>
						</div>
						
						 	<div class="col-md-2" style="padding-right: 0px;">
							<div class="form-group">
								&nbsp; <a href="javascript:void(0)"> <span
											class="glyphicon glyphicon-pencil" aria-hidden="true"
											style="color: black; vertical-align: middle; width: 10px; height: 6px"
											onclick="openModel(3)"></span></a>&nbsp;&nbsp;&nbsp; <a
											href="javascript:void(0)"> <span
											class="glyphicon glyphicon-remove" aria-hidden="true"
											style="color: red; vertical-align: middle; width: 10px; height: 6px"
											onclick=" resetParams(3);"></span></a>
							    </div>
						</div>
						</div>
						
						<!--签约方类型-->
						<div id="search_div" class="col-md-12">
		               	<div class="col-md-12" style="padding-right: 0px;">
							<div class="form-group">
								<label class="col-sm-3 control-label search_div"
									style="width: 120px;">签约方类型:</label>
								<div class="col-sm-9 search_div" style="width: 180px;">
									<select id="contract_party_type" name="contract_party_type"
									class="form-control" style="width: 100px;">
									<option value=" "></option>
									<option value="甲方">甲方</option>
									<option value="乙方">乙方</option>
									<option value="丙方">丙方</option>
									<option value="丁方">丁方</option>
								</select>
								<input type="hidden" id="init_contract_party_type" th:value="${ContractEnter.contractPartyType}" />
								</div>
							</div>
						</div>
			        </div>
			    </form>
				</div>
			</div>
			
				<div style="text-align: center;margin-bottom: 10px;">
				 <button type="button" onclick="suerChoose(2)" class="btn btn-primary" style="margin-right: 25px;width: 80px;">确定</button> 
				 <button type="button" onclick="fnCloseWin(2)" class="btn btn-primary" style="margin-right: 25px;width: 80px;">关闭</button>
			</div>
				
			</div>
		</div>
	</div>


<!--供应商模态框 -->
	<div class="modal fade" id="openSupplierChooseModal" role="dialog"
		aria-labelledby="myModalLabel" data-backdrop="static"
		aria-hidden="true">
		<div class="container-fluid" role="document" style="width: 800px">
			<div class="modal-content">

				<div style="float: right;">
					<button type="button" class="close" data-dismiss="modal"
						style="color: white; background-color: red; width: 25px; height: 25px;">×</button>
				</div>
				
				<div class="modal-body" style="overflow: hidden; padding: 10px;">
					<div class="box box-default collapsed-box box-solid"
						style="margin-bottom: 5px; background: #DEF2FF; height: 28px;">
						<h4 id="modal_title" class="modal-title" style="color: blue;">供应商信息</h4>
					</div>
				</div>
				
               <div class="box box-default collapsed-box box-solid" style="margin-bottom: 5px;border-color: #DEF2FF;">
				<div class="box-header with-border">
				<form id="formSearch" class="form-horizontal">
			        <div id="search_div" class="col-md-12">
		               
		                <div class="col-md-4" style="padding-right: 0px;">
	            			<div class="form-group">
			                  	<label class="col-sm-5 control-label search_div" style="width:  120px;">供应商编码:</label>
			                  	<div class="col-sm-7 search_div" style="width: 130px;">
		                    	 	<input type="text" class="form-control" id="fNumber" name="fNumber" value="" onkeyup="this.value=this.value.replace(/\s+/g,'')" />
			                  	</div>
			                </div>
	            		</div>
		                
		                <div class="col-md-4" style="padding: 0px;">
	            			<div class="form-group">
			                  	<label class="col-sm-5 control-label search_div" style="width: 120px;">供应商名称:</label>
			                  	<div class="col-sm-7 search_div" style="width: 130px;">
			                  	<div class="input-group date">
		                    	 	<input type="text" class="form-control" id="fName" name="fName" onkeyup="this.value=this.value.replace(/\s+/g,'')"/>
				                    <input type="hidden" class="form-control" id="fEffectedStatus" name="fEffectedStatus"/> 
				                  	</div>
			                  	</div>
			                </div>
	            		</div>
	            		
	            		
	            		<div class="col-md-4 btn-group" style="padding: 0px;">
					    	<button id="btn_add" type="button" class="btn btn-default" onclick="queryInfo(2);">
					        	<span class="glyphicon glyphicon-search" aria-hidden="true" style="color: #18A689"></span>查询
					        </button>
					        <button id="btn_edit" type="button" class="btn btn-default" onclick="resetParams(2);">
					            <span class="glyphicon glyphicon-repeat" aria-hidden="true" style="color: #EC4758"></span>重置
					        </button>
	            		</div>
			        </div>
			    </form>
				</div>
			</div>
              <table id="supplierList"></table>
				<div style="text-align: center;margin-bottom: 10px;">
				 <button type="button" onclick="suerChoose(3)" class="btn btn-primary" style="margin-right: 25px;width: 80px;">确定</button> 
				 <button type="button" onclick="fnCloseWin(3)" class="btn btn-primary" style="margin-right: 25px;width: 80px;">关闭</button>
			 </div>
				
			</div>
		</div>
	</div>
	
	
	<!--法务审核人模态框 -->
	<div class="modal fade" id="openAuditorModal" role="dialog"
		aria-labelledby="myModalLabel" data-backdrop="static"
		aria-hidden="true">
		<div class="container-fluid" role="document" style="width: 800px">
			<div class="modal-content">

				<div style="float: right;">
					<button type="button" class="close" data-dismiss="modal"
						style="color: white; background-color: red; width: 25px; height: 25px;">×</button>
				</div>
				
				<div class="modal-body" style="overflow: hidden; padding: 10px;">
					<div class="box box-default collapsed-box box-solid"
						style="margin-bottom: 5px; background: #DEF2FF; height: 28px;">
						<h4 id="modal_title" class="modal-title" style="color: blue;">法务审核员</h4>
					</div>
				</div>
				
              <table id="auditorList"></table>
				<div style="text-align: center;margin-bottom: 10px;">
				 <button type="button" onclick="suerChoose(4)" class="btn btn-primary" style="margin-right: 25px;width: 80px;">确定</button> 
				 <button type="button" onclick="fnCloseWin(4)" class="btn btn-primary" style="margin-right: 25px;width: 80px;">关闭</button>
			 </div>
				
			</div>
		</div>
	</div>
	
	<!--会计审核人模态框 -->
	<div class="modal fade" id="openAccoutingAuditorModal" role="dialog"
		aria-labelledby="myModalLabel" data-backdrop="static"
		aria-hidden="true">
		<div class="container-fluid" role="document" style="width: 800px">
			<div class="modal-content">

				<div style="float: right;">
					<button type="button" class="close" data-dismiss="modal"
						style="color: white; background-color: red; width: 25px; height: 25px;">×</button>
				</div>
				
				<div class="modal-body" style="overflow: hidden; padding: 10px;">
					<div class="box box-default collapsed-box box-solid"
						style="margin-bottom: 5px; background: #DEF2FF; height: 28px;">
						<h4 id="modal_title" class="modal-title" style="color: blue;">会计审核员</h4>
					</div>
				</div>
				
              <table id="accoutingAuditorList"></table>
				<div style="text-align: center;margin-bottom: 10px;">
				 <button type="button" onclick="suerChoose(5)" class="btn btn-primary" style="margin-right: 25px;width: 80px;">确定</button> 
				 <button type="button" onclick="fnCloseWin(5)" class="btn btn-primary" style="margin-right: 25px;width: 80px;">关闭</button>
			 </div>
				
			</div>
		</div>
	</div>
	
	<!-- 附件上传通用窗口 -->
	<div class="modal fade modal-info" id="upload_annex_win" role="dialog" data-backdrop="false" aria-hidden="true">
		<div class="modal-dialog" style="width:900px;">
	      	<div class="modal-content" style="background-color:rgba(255, 255, 255, 0);">
		        <div class="modal-header" style="padding:5px;">
		          	<button type="button" class="close" data-dismiss="modal" aria-label="Close" style="margin-top:0;">
		            	<span aria-hidden="true">&times;</span>
		            </button>
		            <button type="button" class="close" style="margin-right:5px;margin-top: -1px;" onclick="fnMaxModalWin2(this)">
		            	<i class="fa fa-square-o" style="font-size:16px;"></i>
		            </button>
		          	<h4 class="modal-title" style="text-align:center;"></h4>
		        </div>
		        <div class="modal-body" style="height: 500px;padding:0px;background-color: rgba(3, 51, 101, 0.9) !important;">
		          	<iframe id="annexFrame" name="annexFrame" style="width: 100%;height:100%;border:0;"></iframe>
		        </div>
	      	</div>
		</div>
	</div>

</body>
<!-- jQuery 2.2.3 -->
<script th:src="@{/static/plugins/jQuery/jquery-2.2.3.min.js}"></script>
<!-- Bootstrap 3.3.7 -->
<script th:src="@{/static/bootstrap/js/bootstrap.min.js}"></script>
<script th:src="@{/static/js/common.js}"></script>
<script
	th:src="@{/static/plugins/bootstrap-validator/js/bootstrapValidator.min.js}"></script>
<script
	th:src="@{/static/plugins/bootstrap-table/dist/bootstrap-table.min.js}"></script>
<script
	th:src="@{/static/plugins/bootstrap-table/dist/locale/bootstrap-table-zh-CN.min.js}"></script>
<script th:src="@{/static/plugins/jQuery/jquery.serializejson.min.js}"></script>
<script th:src="@{/static/plugins/datepicker/bootstrap-datepicker.js}"></script>
<script
	th:src="@{/static/plugins/datepicker/locales/bootstrap-datepicker.zh-CN.js}"></script>
<script type="text/javascript"
	th:src="@{/static/plugins/bootstrap-toggle/bootstrap-toggle.min.js}"></script>
<script
	th:src="@{/static/plugins/bootstrap-table/dist/extensions/export/bootstrap-table-export.min.js}"></script>
<script type="text/javascript"
	th:src="@{/static/plugins/bootstrap-treeview/bootstrap-treeview.min.js}"></script>
<script type="text/javascript"
	th:src="@{/static/plugins/bootstrap-contextmenu/bootstrap-contextmenu.js}"></script>
<script type="text/javascript"
	th:src="@{/static/plugins/bootstrap-contextmenu/prettify.js}"></script>
<script type="text/javascript"
	th:src="@{/static/plugins/attention/zDialog/zDrag.js}"></script>
<!-- Slimscroll -->
<script type="text/javascript"
	th:src="@{/static/plugins/slimScroll/jquery.slimscroll.min.js}"></script>
<script type="text/javascript" th:src="@{/static/dist/js/app.min.js}"></script>
<script type="text/javascript" th:src="@{/static/js/common.js}"></script>
<script th:inline="javascript" type="text/javascript">
/*<![CDATA[*/
	var CTX = [[@{/}]];
		$(function () {
			
			$("#fEffectedStatus").val(" ");
			//1.初始化各个Table
			//合同信息的表格
		    var oTable = new TableInit();
		    oTable.Init();
		    //供应商的表格
		    var oSupplierTableInit=new SupplierTableInit();
		    oSupplierTableInit.Init();
		    //法务审核人表格
		    var oAuditorTableInit=new AuditorTableInit();
		    oAuditorTableInit.Init();
		    //会计审核人表格
		    var oAccoutingAuditorTableInit=new AccoutingAuditorTableInit();
		    oAccoutingAuditorTableInit.Init();
		    //2.初始化Button的点击事件
		    var oButtonInit = new ButtonInit();
		    
		    //合同摘要表
		    var contractOwner=$("#contractOwner").val();
			var contractOwnerDept=$("#contractOwnerDept").val();
			$("#spanContractOwner").text(contractOwner);
			$("#spanContractOwnerDept").text(contractOwnerDept);
			reviseInit();
		    oButtonInit.Init();
		    //初始化时间控件
		    $('.datepicker').datepicker({
		    	format:'yyyy-mm',
		    	language:'zh-CN',
		      	autoclose: true,
		      	startView: 'months', //开始视图层，为月视图层
		        maxViewMode:'years', //最大视图层，为年视图层
		        minViewMode:'months', //最小视图层，为月视图层
		        clearBtn: true
		    }).on('hide',function(){
				
			});
		});
		
		
	    //修改界面数据初始化
	      function reviseInit(){
	    	 var  chooseConfirmWay=$("#chooseConfirmWay").val();//合同确定方式
	    	 var  initIsLeaderApproval=$("#init_isLeader_Approval").val();//是否需要领导审批
	    	 var  initIsStamp=$("#init_is_Stamp").val();//是否需要公司盖章
	    	 //合同确定方式判断是否为空
	    	 if(chooseConfirmWay!=null&&chooseConfirmWay!=""){
	    		 $(":radio[name='contract_ConfirmWay'][value='" + chooseConfirmWay + "']").prop("checked", "checked");
	    		 var contractConfirmWay=$("input[name='contract_ConfirmWay']:checked").val();
	    		 $("input[name='contractConfirmWay']").val(contractConfirmWay);
	    	 }
	    	    //签约方
	    		$("input[name='contractPartyType']").val($("#init_contract_party_type").val());
				$("input[name='signContractPeople']").val($("#init_sign_contract_people").val());
				$("#spanSignContractPeople").text($("#init_sign_contract_people").val());
				//法务审核人
				$("input[name='legalAuditor']").val($("#legal_Auditor").val());
				$("input[name='legalAuditorId']").val($("#legalAuditorId").val());

				$("input[name='accoutingAuditor']").val($("#accouting_Auditor").val());
				$("input[name='accoutingAuditorId']").val($("#accoutingAuditorId").val());
				
				//是否需要盖章
		       $(":radio[name='isLeader_Approval'][value='" + initIsLeaderApproval + "']").prop("checked", "checked");
			   $(":radio[name='is_Stamp'][value='" + initIsStamp + "']").prop("checked", "checked");
			   
			   //附件id
                annexIds=[];
                var annexArr=getAllAnnexId();
                var arr=annexArr.split(",");
                for(var i=0;i<arr.length;i++){
                  annexIds.push(arr[i]);
                }
			}
		
		
		var TableInit = function () {
		    var oTableInit = new Object();
		    //初始化项目的Table
		    oTableInit.Init = function () {
		        $('#dataList').bootstrapTable({
		        	url: CTX + 'project/send-project-message-manage', //请求后台的URL（*）
		            method: 'get',                      //请求方式（*）
		            striped: true,                      //是否显示行间隔色
		            cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
		            pagination: true,                   //是否显示分页（*）
		            sortable: false,                     //是否启用排序
		            sortOrder: "asc",                   //排序方式
		            queryParams: oTableInit.queryParams,//传递参数（*）
		            sidePagination: "server",           //分页方式：client客户端分页，server服务端分页（*）
		            pageNumber:1,                       //初始化加载第一页，默认第一页
		            pageSize: 5,                        //每页的记录行数（*）
		            pageList: [10, 25, 50, 100],        //可供选择的每页的行数（*）
		            queryParamsType: "a",
		            strictSearch: true,
		            minimumCountColumns: 2,             //最少允许的列数
		            uniqueId: "id",                     //每一行的唯一标识，一般为主键列
		            undefinedText: "",
		            columns: [
					{
					    field: 'number',
					    title:'序号',
					    align : 'center',
					    sortable:true,
					    formatter:function(value,row,index){
					    	var pageSize=$('#dataList').bootstrapTable('getOptions').pageSize;
			                var pageNumber=$('#dataList').bootstrapTable('getOptions').pageNumber;
			                return pageSize * (pageNumber - 1) + index + 1;
					    }
					},{
					    field: 'projectName',
					    title:'项目名称',
					    align : 'center',
					    sortable:true,
					},{
					    field: 'projectCode',
					    title:'项目编码',
					    align : 'center',
					    sortable:true
					},
					{
					    field: 'operation',
					    title:'操作',
					    align : 'center',
					    sortable:true,
					    formatter:function(v,r,i){
							return '<input type="radio" onclick="chooseRadio(this)" name="projectData" title='+r.projectName+'  id='+r.id+' />';
		   				}
					},
					]
		        });
		    };
		    //得到查询的参数
		    oTableInit.queryParams = function (params) {
		        var temp = {   //这里的键的名字和控制器的变量名必须一致，这边改动，控制器也需要改成一样的
		        	pageNum: params.pageNumber,//页码params.offset
	                size: params.pageSize,//页面大小params.limit
	                projectName:$("input[name='projectName']").val(),
	                projectCode:$("input[name='projectCode']").val(),
		        };
		        return temp;
		    };
		    return oTableInit;
		};
		
		//初始化供应商列表
		var SupplierTableInit = function () {
		    var oSupplierTableInit = new Object();
		    //初始化Table
		    oSupplierTableInit.Init = function () {
		        $('#supplierList').bootstrapTable({
		        	url: CTX + 'supplier/send-supplier-manage', //请求后台的URL（*）
		            method: 'get',                      //请求方式（*）
		            striped: true,                      //是否显示行间隔色
		            cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
		            pagination: true,                   //是否显示分页（*）
		            sortable: false,                     //是否启用排序
		            sortOrder: "asc",                   //排序方式
		            queryParams: oSupplierTableInit.queryParams,//传递参数（*）
		            sidePagination: "server",           //分页方式：client客户端分页，server服务端分页（*）
		            pageNumber:1,                       //初始化加载第一页，默认第一页
		            pageSize: 5,                       //每页的记录行数（*）
		            pageList: [10, 25, 50, 100],        //可供选择的每页的行数（*）
		            queryParamsType: "a",
		            strictSearch: true,
		            minimumCountColumns: 2,             //最少允许的列数
		            uniqueId: "id",                     //每一行的唯一标识，一般为主键列
		            undefinedText: "",
		            columns: [
					{
					    field: 'number',
					    title:'序号',
					    align : 'center',
					    sortable:true,
					    formatter:function(value,row,index){
					    	var pageSize=$('#supplierList').bootstrapTable('getOptions').pageSize;
			                var pageNumber=$('#supplierList').bootstrapTable('getOptions').pageNumber;
			                return pageSize * (pageNumber - 1) + index + 1;
					    }
					},{
					    field: 'FNumber',
					    title:'供应商编码',
					    align : 'center',
					    sortable:true,
					},{
					    field: 'FName',
					    title:'供应商名称',
					    align : 'center',
					    sortable:true
					},
					{
					    field: 'operation',
					    title:'操作',
					    align : 'center',
					    sortable:true,
					    formatter:function(v,r,i){
							return '<input type="radio" onclick="chooseRadio(this)" name="supplierData" title='+r.FName+'  id='+r.id+' />';
		   				}
					},
					]
		        });
		      
		    };
		    //得到查询的参数
		    oSupplierTableInit.queryParams = function (params) {
		        var temp = {   //这里的键的名字和控制器的变量名必须一致，这边改动，控制器也需要改成一样的
		        	pageNum: params.pageNumber,//页码params.offset
	                size: params.pageSize,//页面大小params.limit
	                fNumber: $("input[name='fNumber']").val(),
	                fEffectedStatus: $("#fEffectedStatus").val(),
	                fName: $("input[name='fName']").val(),
		        };
		        return temp;
		    };
		    return oSupplierTableInit;
		};
		
		//法务审核人表格
		var AuditorTableInit = function () {
		    var oAuditorTableInit = new Object();
		    //初始化Table
		    oAuditorTableInit.Init = function () {
		        $('#auditorList').bootstrapTable({
		        	url: CTX + 'contract/auditor-view', //请求后台的URL（*）
		            method: 'get',                      //请求方式（*）
		            striped: true,                      //是否显示行间隔色
		            cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
		            pagination: true,                   //是否显示分页（*）
		            sortable: false,                     //是否启用排序
		            sortOrder: "asc",                   //排序方式
		            queryParams: oAuditorTableInit.queryParams,//传递参数（*）
		            sidePagination: "server",           //分页方式：client客户端分页，server服务端分页（*）
		            pageNumber:1,                       //初始化加载第一页，默认第一页
		            pageSize: 5,                       //每页的记录行数（*）
		            pageList: [10, 25, 50, 100],        //可供选择的每页的行数（*）
		            queryParamsType: "a",
		            strictSearch: true,
		            minimumCountColumns: 2,             //最少允许的列数
		            uniqueId: "id",                     //每一行的唯一标识，一般为主键列
		            undefinedText: "",
		            columns: [
					{
					    field: 'number',
					    title:'序号',
					    align : 'center',
					    sortable:true,
					    formatter:function(value,row,index){
					    	var pageSize=$('#auditorList').bootstrapTable('getOptions').pageSize;
			                var pageNumber=$('#auditorList').bootstrapTable('getOptions').pageNumber;
			                return pageSize * (pageNumber - 1) + index + 1;
					    }
					},{
					    field: 'userName',
					    title:'法务审核员',
					    align : 'center',
					    sortable:true,
					},
					{
					    field: 'operation',
					    title:'操作',
					    align : 'center',
					    sortable:true,
					    formatter:function(v,r,i){
							return '<input type="radio" onclick="chooseRadio(this)" name="supplierData" title='+r.userName+'  id='+r.userId+' />';
		   				}
					},
					]
		        });
		      
		    };
		    //得到查询的参数
		    oAuditorTableInit.queryParams = function (params) {
		        var temp = {   //这里的键的名字和控制器的变量名必须一致，这边改动，控制器也需要改成一样的
	                roleName:"合同法务审核人",
		        };
		        return temp;
		    };
		    return oAuditorTableInit;
		};
		
		//会计审核人表格
		var AccoutingAuditorTableInit = function () {
		    var oAccoutingAuditorTableInit = new Object();
		    //初始化Table
		    oAccoutingAuditorTableInit.Init = function () {
		        $('#accoutingAuditorList').bootstrapTable({
		        	url: CTX + 'contract/auditor-view', //请求后台的URL（*）
		            method: 'get',                      //请求方式（*）
		            striped: true,                      //是否显示行间隔色
		            cache: false,                       //是否使用缓存，默认为true，所以一般情况下需要设置一下这个属性（*）
		            pagination: true,                   //是否显示分页（*）
		            sortable: false,                     //是否启用排序
		            sortOrder: "asc",                   //排序方式
		            queryParams: oAccoutingAuditorTableInit.queryParams,//传递参数（*）
		            sidePagination: "server",           //分页方式：client客户端分页，server服务端分页（*）
		            pageNumber:1,                       //初始化加载第一页，默认第一页
		            pageSize: 5,                       //每页的记录行数（*）
		            pageList: [10, 25, 50, 100],        //可供选择的每页的行数（*）
		            queryParamsType: "a",
		            strictSearch: true,
		            minimumCountColumns: 2,             //最少允许的列数
		            uniqueId: "id",                     //每一行的唯一标识，一般为主键列
		            undefinedText: "",
		            columns: [
					{
					    field: 'number',
					    title:'序号',
					    align : 'center',
					    sortable:true,
					    formatter:function(value,row,index){
					    	var pageSize=$('#accoutingAuditorList').bootstrapTable('getOptions').pageSize;
			                var pageNumber=$('#accoutingAuditorList').bootstrapTable('getOptions').pageNumber;
			                return pageSize * (pageNumber - 1) + index + 1;
					    }
					},{
					    field: 'userName',
					    title:'会计审核员',
					    align : 'center',
					    sortable:true,
					},
					{
					    field: 'operation',
					    title:'操作',
					    align : 'center',
					    sortable:true,
					    formatter:function(v,r,i){
							return '<input type="radio" onclick="chooseRadio(this)" name="supplierData" title='+r.userName+'  id='+r.userId+' />';
		   				}
					},
					]
		        });
		      
		    };
		    //得到查询的参数
		    oAccoutingAuditorTableInit.queryParams = function (params) {
		        var temp = {   //这里的键的名字和控制器的变量名必须一致，这边改动，控制器也需要改成一样的
	                roleName:"合同会计审核人",
		        };
		        return temp;
		    };
		    return oAccoutingAuditorTableInit;
		};
		
		/* ------------------------------------- */
		//失去焦点事件
		function loseFocus(){
			var contractName=$("#contractName").val();
			var contractNumber=$("#contractNumber").val();
			var contractOwner=$("#contractOwner").val();
			var contractOwnerDept=$("#contractOwnerDept").val();
			var contractConfirmWay=$("input[name='contract_ConfirmWay']:checked").val();
			var contractSigningBasis=$("#contractSigningBasis").val();
			var contractMainThing=$("#contractMainThing").val();
		    var contractMoney=$("#contractMoney").val();
			
			$("#spanContractName").text(contractName);
			$("#spanContractNumber").text(contractNumber);
			$("#spanContractMoney").text(contractMoney);
			$("#spanContractMoney").text(contractMoney);
			$("#spanContractMainThing").text(contractMainThing);
			$("#spanContractSigningBasis").text(contractSigningBasis);
			$("#spanContractConfirmWay").text(contractConfirmWay);
		}
		
		//查询-刷新
		var queryInfo = function(Type){
			if(Type==1){//项目查询
				var data = JSON.stringify($('#formSearch').serializeJSON());
				var queryData = {from: data};
				$('#dataList').bootstrapTable('refreshOptions',{pageNumber:1,pageSize:5,query:queryData});	
			}else if(Type==2){//供应商查询
				var data = JSON.stringify($('#formSupplierSearch').serializeJSON());
				var queryData = {from: data};
				$('#supplierList').bootstrapTable('refreshOptions',{pageNumber:1,pageSize:5,query:queryData});
			}else if(Type==3){
				var queryData = {roleName: "法务审核人"};
				$('#auditorList').bootstrapTable('refreshOptions',{pageNumber:1,pageSize:5,query:queryData});
			}else if(Type==4){
				var queryData = {roleName: "会计审核人"};
				$('#accoutingAuditorList').bootstrapTable('refreshOptions',{pageNumber:1,pageSize:5,query:queryData});
			}
		}
		
		//点击事件保存名称和id
		var code;
		var name;
		var obj;
		function chooseRadio(node){
			 name =node.title;
			 code =node.id;
			 obj=node;
		}
		
		//初始化按钮
		var ButtonInit = function () {
		    var oInit = new Object();
		    var postdata = {};

		    oInit.Init = function () {
		        //初始化页面上面的按钮事件
		    };
		    return oInit;
		};
		
		//打开模态框
		function openModel(Type){
			if(Type==1){//项目名称
				queryInfo(1);
				$('#openProjectModal').modal('toggle');
			}else if(Type==2){//合同签约方
				$("#contract_party_type").val(" ");
				$('#openSupplierModal').modal('toggle');
			}else if(Type==3){//签约方的供应商选择
				queryInfo(2);
				$('#openSupplierChooseModal').modal('toggle');
			}else if(Type==4){//法务审核人
				queryInfo(3);
				$('#openAuditorModal').modal('toggle');
			}else if(Type==5){//会计审核人
				queryInfo(4);
				$("#openAccoutingAuditorModal").modal('toggle');
			}
			
		}         
		

		//关闭模态框
		function fnCloseWin(Type){
			if(Type==1){//项目名称
				resetParams(1);
				$('#openProjectModal').modal('toggle');
			}else if(Type==2){//签约方模态
				$("#sign_contract_name").val("");
				$("#contract_party_type").val("");
				$('#openSupplierModal').modal('toggle');
			}else if(Type==3){//供应商模态
				resetParams(2);
				$('#openSupplierChooseModal').modal('toggle');
			}else if(Type==4){//法务审核人
				$('#openAuditorModal').modal('toggle');
			}else if(Type==5){//会计审核人
				$('#openAccoutingAuditorModal').modal('toggle');
			}
		}
		
		//确定合同数据
		function suerChoose(Type){
			
			if(Type==1){//合同名称
				var val=$('input:radio[name="projectData"]:checked').val();
				  if(val==null){
					  alert("请选择项目!");
					  return
				  }else{
					  //$("#project_Name").val(name);
					  $("input[name='project_Name']").val(name);
					  $("input[name='projectId']").val(code);
					  //$("#projectId").val(code);
					  $('#openProjectModal').modal('toggle');
					  //单选框默认样式-搜索框重置
					  $('input:radio[name="projectData"]:checked').attr("checked",false);
					  resetParams(1);
				  }
			 }else if(Type==2){//签约方模态框值
				 if($("#sign_contract_name")==" "){
					 alert("请选择签约公司！");
	                 return;	
				 }
				 
				 if($("#contract_party_type").val()==" "){
					alert("请选择签约类型！");
                    return;					
				}
				var com="甲方:厦门轨道物资有限公司  / "+$("#contract_party_type").val()+":"+$("#sign_contract_name").val();
				$("input[name='sign_Contract_People']").val(com);
				$("#spanSignContractPeople").text($("#sign_contract_name").val());
				$("input[name='contractPartyType']").val($("#contract_party_type").val());
				$("input[name='signContractPeople']").val($("#sign_contract_name").val());
				$('#openSupplierModal').modal('toggle');
				resetParams(3);
			}else if(Type==3){//合同签约方-合同界面
				$("input[name='sign_contract_name']").val(name);
				$("#sign_contract_name").val(name); 
				$('#openSupplierChooseModal').modal('toggle');
			}else if(Type==4){//法务审核人
				$("input[name='legalAuditor']").val(name);
				$("input[name='legalAuditorId']").val(code);
				$('#openAuditorModal').modal('toggle');
			}else if(Type){//会计审核人
				$("input[name='accoutingAuditor']").val(name);
				$("input[name='accoutingAuditorId']").val(code);
				$("#openAccoutingAuditorModal").modal('toggle');
			}
		}
		
		
		//合同主界面删除输入框数据
		function delContractData(Type){
			if(Type==1){//项目名称
				$("input[name='project_Name']").val("");
			}else if(Type==2){//签约方名称
				$("input[name='sign_Contract_People']").val("");
				$("#spanSignContractPeople").text("");
				$("input[name='contractPartyType']").val("");
				$("input[name='signContractPeople']").val("");
			}else if(Type==3){//法务审核人
				$("input[name='legalAuditor']").val("");
			}else if(Type==4){//会计审核人
				$("input[name='accoutingAuditor']").val("");
			}
		}
		
		//重置项目信息查询的参数
		function  resetParams(Type){
			 if(Type==1){//项目名称
				 $("#projectCode").val(" ");
				 $("#projectName").val(" "); 
			 }else if(Type==2){//供应商
				 $("input[name=fName]").val(" ");
				 $("input[name=fNumber]").val(" ");
			 }else if(Type==3){//签约模态框界面
				 $("#sign_contract_name").val(" ");
				 $("#contract_party_type").val(" ");
			 }
			
		}
		/* ------------------------------------- */
 
		
	//上传附件
	var annexIds=[];//保存上传的附件id
	function fnUploadAnnex(folderId,folderName){
		//调用统一附件管理页面
		window.top.openUploadAnnexWin({
			folderId:folderId,
			folderName:folderName/* ,
			annexIds:annexIdStr */
		},function(data){
			//附件管理回调
			if(data.length>0){
				var tbody = document.getElementById("annexList_body");
				var allRows = tbody.getElementsByTagName('tr');
				
				if(allRows != null && allRows.length > 0){
					var tds = allRows[0].getElementsByTagName('td');
					if(tds.length == 1){//原本无附件
						var children = tbody.childNodes;
						for(var i = children.length -1; i >= 0; i--){
							tbody.removeChild(children[i]);
						}
					}
				}
				
				var index = allRows == null ? 1 : allRows.length + 1;
				$.each(data,function(i,annex){
					addAnnexRow(index,annex);
					index++;
				});
			}
			//单独保存附件字段
			fnSaveReportAnnexes();
		});
	}
	
	
	//------------------------------合同正文的附件上传----------------------
	
	function fnUploadContractAnnex(folderId,folderName){
		//判断当前的有几行
		var tab = document.getElementById("contractAnnexs") ;
		var rows = tab.rows.length;
		var value = tab.rows.length;
		if(rows==2&&tab.rows[1].cells.length!=1){
			alert("请先删除之前的合同");
			return
		}
		
		//调用统一附件管理页面
		window.top.openUploadContractAnnexWin({
			folderId:folderId,
			folderName:folderName/* ,
			annexIds:annexIdStr */
		},function(data){
			//附件管理回调
			if(data.length>0){
				var tbody = document.getElementById("contractAnnexList_body");
				var allRows = tbody.getElementsByTagName('tr');
				
				if(allRows != null && allRows.length > 0){
					var tds = allRows[0].getElementsByTagName('td');
					if(tds.length == 1){//原本无附件
						var children = tbody.childNodes;
						for(var i = children.length -1; i >= 0; i--){
							tbody.removeChild(children[i]);
						}
					}
				}
				var index = allRows == null ? 1 : allRows.length + 1;
				$.each(data,function(i,annex){
					addContractAnnexRow(index,annex);
					index++;
				});
				//合同正文修改
				$("input[name='contractTextAnnexId']").val(annexContract);
			}
			//单独保存附件字段
			fnSaveReportAnnexes();
		});
	}
	
	//附件上传成功，表格添加行数据
	var annexContract;
	function addContractAnnexRow(index,annex){
		var tBody = document.getElementById("contractAnnexList_body");
		var allRows = tBody.getElementsByTagName('tr');
		var newRow = tBody.insertRow();
	    var newCell0 = newRow.insertCell();
	    var newCell1 = newRow.insertCell();
	    var newCell4 = newRow.insertCell();
	    newCell0.innerHTML = "<input hidden=\"hidden\" name=\"fieldIds\" value=\"" + annex.id+ "\"/>" + "<span>"+index+"</span>";
	    newCell1.innerHTML = "<a href=\"javascript:\" onclick=\"window.top.openCommonViewImgWin(\'"+annex.id+"\')\">"+
	    	annex.name + "." + annex.extendName +"</a>";
	    newCell4.innerHTML = "<a href=\"javascript:\" onclick=\"fnDeleteContractAnnex(this,\'"+ annex.id +"\')\">"
	    				+ "<span class=\"glyphicon glyphicon-remove\" aria-hidden=\"true\" style=\"color: red;\" title=\"删除\"></span>"
	    				+ "</a>";
	    annexContract=annex.id;
	    var contractId=$("#contractId").val();
	    $.ajax({
			url:CTX+'contract/revise-contract-text',
			method:'post',
			data:{"id":contractId,"annexContract":annexContract},
			success:function(json){
			},
			error:function(){
				alert('请求超时或网络错误');
			}
		}); 
	}
	
	//删除附件
	function fnDeleteContractAnnex(obj,id){
		fnSendDelAnnex(id);
		var index = obj.parentNode.parentNode.rowIndex;
		//console.log("删除附件：" + id);
		document.getElementById("contractAnnexs").deleteRow(index);
		
		//重新排序
		var tBody = document.getElementById("contractAnnexList_body");
		var allRows = tBody.getElementsByTagName('tr');
		for(var i=0;i<allRows.length;i++){
			var firstCell = allRows[i].getElementsByTagName('td')[0];
			var span = firstCell.getElementsByTagName('span')[0];
			span.innerHTML = i+1;
		}
	}
	
	function fnMaxModalWin2(_this){
		if($(_this).find('i').hasClass('fa-square-o')){
			//执行最大化窗口
			$(_this).parent().parent().parent().parent().css({'overflow-y':'hidden'});
			$(_this).parent().parent().parent().css({width:$(window).width()+'px',margin:'0px auto'});
			$(_this).parent().next().css({height:($(window).height()-$(_this).parent().outerHeight())+'px'});
			$(_this).find('i').removeClass('fa-square-o');
			$(_this).find('i').addClass('fa-clone');
		}else{
			//还原窗口大小
			$(_this).parent().parent().parent().parent().css({'overflow-y':'auto'});
			$(_this).parent().parent().parent().css({width:'900px',margin:'30px auto'});
			$(_this).parent().next().css({height:'500px'});
			$(_this).find('i').removeClass('fa-clone');
			$(_this).find('i').addClass('fa-square-o');
		}
	}
	var ANNEX_CALLBACK = null;
	
	
	//附件子页面回调
	function closeUploadAnnexWin(){
		$('#upload_annex_win').modal('toggle');
	}
	
	//打开图片查看窗口
	function openCommonViewImgWin(annexIds){
		if(annexIds==null||annexIds==''){
			alert('附件不存在');
			return;
		}
		loading('加载中...');
		$.ajax({
			url:CTX+'annex/query-annex',
			type:'get',
			dataType:'json',
			timeout:10000,
			data: {annexIds:annexIds},
			success:function(json){
				loaded();
				if(json&&json.length>0){
					var liStr = '',imgStr = '';
					$.each(json,function(i,annex){
						if(annex.extendName.toLowerCase()=='jpg'||annex.extendName.toLowerCase()=='jpeg'||
								annex.extendName.toLowerCase()=='bmp'||annex.extendName.toLowerCase()=='gif'||
								annex.extendName.toLowerCase()=='png'){
							liStr += '<li data-target="#myCarousel" data-slide-to="'+i+'" '+(i==0?'class="active"':'')+'></li>';
							imgStr += 
								'<div class="item '+(i==0?'active':'')+'">'+
								'	<img src="'+STATIC+annex.relativePath+'" alt="'+annex.name+'" onerror="this.src=\''+STATIC+'images/noPicture.jpg\';" style="margin:0 auto;max-width:100%;"/>'+
								'	<div class="carousel-caption">'+annex.name+'</div>'+
								'</div>';
						}
					});
					if(liStr!=''&&imgStr!=''){
						$('#common_viewimg_win .modal-body').html(
							'<div id="myCarousel" class="carousel slide">'+
							'<ol class="carousel-indicators">'+
							liStr+
							'</ol>'+
							'<div class="carousel-inner">'+
							imgStr+
							'</div>'+
							'<a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">'+
							'    <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>'+
							'    <span class="sr-only">Previous</span>'+
							'</a>'+
							'<a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">'+
							'    <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>'+
							'    <span class="sr-only">Next</span>'+
							'</a>'+
							'</div>'
						);
						$('#common_viewimg_win').modal('toggle');
					}else{
						$.each(json,function(i,annex){
							window.location.href = STATIC+annex.relativePath;
						});
					}
				}else{
					$('#common_viewimg_win').modal('toggle');
					$('#common_viewimg_win .modal-body').html('<div class="img_div" style="width:100%; height:100%;text-align:center;"><img src="'+STATIC+'images/noPicture.jpg" style="max-width:100%;height:auto;"/></div>');
				}
			},
			error:function(){
				alert('请求超时或系统错误');
				loaded();
			}
		});
	}
	//----------------------------------------
	//附件上传成功，表格添加行数据
	function addAnnexRow(index,annex){
		var tBody = document.getElementById("annexList_body");
		var allRows = tBody.getElementsByTagName('tr');
		var newRow = tBody.insertRow();
	    var newCell0 = newRow.insertCell();
	    var newCell1 = newRow.insertCell();
	    var newCell2 = newRow.insertCell();
	    var newCell3 = newRow.insertCell();
	    var newCell4 = newRow.insertCell();
	    
	    newCell0.innerHTML = "<input hidden=\"hidden\" name=\"fieldIds\" value=\"" + annex.id+ "\"/>" + "<span>"+index+"</span>";
	    newCell1.innerHTML = "<a href=\"javascript:\" onclick=\"window.top.openCommonViewImgWin(\'"+annex.id+"\')\">"+
	    	annex.name + "." + annex.extendName +"</a>";
	    newCell2.innerHTML = annex.creator;
	    newCell3.innerHTML = formatDate(annex.uploadTime);
	    newCell4.innerHTML = "<a href=\"javascript:\" onclick=\"fnDeleteAnnex(this,\'"+ annex.id +"\')\">"
	    				+ "<span class=\"glyphicon glyphicon-remove\" aria-hidden=\"true\" style=\"color: red;\" title=\"删除\"></span>"
	    				+ "</a>";
	    				
	 annexIds.push(annex.id);
	}
	
	//格式化日期
	function formatDate(time){
	    var date = new Date(time);
	    var year = date.getFullYear(),
	        month = date.getMonth()+1,//月份是从0开始的
	        day = date.getDate(),
	        hour = date.getHours(),
	        min = date.getMinutes(),
	        sec = date.getSeconds();
	    var preArr = Array.apply(null,Array(10)).map(function(elem, index) {
	        return '0'+index;
	    });////开个长度为10的数组 格式为 00 01 02 03

	    var newTime = year + '-' +
	                (preArr[month]||month) + '-' +
	                (preArr[day]||day);/*  + ' ' +
	                (preArr[hour]||hour) + ':' +
	                (preArr[min]||min) + ':' +
	                (preArr[sec]||sec); */
	    return newTime;         
	  }
	
		//获得所有附件的id
		function getAllAnnexId(){
			var annexIdStr = "";
			var fieldIds = document.getElementsByName("fieldIds");
			if(fieldIds.length>0){
				for(var i=0,len=fieldIds.length; i<len; i++){
					annexIdStr += ',' + fieldIds[i].value;
				}
				annexIdStr = annexIdStr.substring(1);
			}
			return annexIdStr;
		}
		
		//批量删除
		function fnDeleteAllAnnex(){
			var annexIdStr = getAllAnnexId();
			if(annexIdStr.length > 0){
				//发送请求
				fnSendDelAnnex(annexIdStr)
				var tbody = document.getElementById("annexList_body");
				var children = tbody.childNodes;
				for(var i = children.length -1; i >= 0; i--){
					tbody.removeChild(children[i]);
				}
			}
		}
		
		//删除附件
		function fnDeleteAnnex(obj,id){
			fnSendDelAnnex(id);
			var index = obj.parentNode.parentNode.rowIndex;
			//console.log("删除附件：" + id);
			document.getElementById("annexList").deleteRow(index);
			
			//重新排序
			var tBody = document.getElementById("annexList_body");
			var allRows = tBody.getElementsByTagName('tr');
			for(var i=0;i<allRows.length;i++){
				var firstCell = allRows[i].getElementsByTagName('td')[0];
				var span = firstCell.getElementsByTagName('span')[0];
				span.innerHTML = i+1;
			}
		}
		

		
		//发送删除附件的请求
		function fnSendDelAnnex(annexId){
			$.ajax({
				url: CTX+"annex/delete-annex",
				type: "POST",
				data: {key: annexId},
				dataType: 'json',
				success: function(data){
					if(data.success){
						return true;
					}
				}
			});
		}
		
		//载入数据
		function loadForm(){
			var contractName=$("#contractName").val();
            var contractConfirmWay=$("input[name='contract_ConfirmWay']:checked").val();
            var contractMatter=$("#contractMatter").val();
            var contractMoney=$("#contractMoney").val();
            var isLeaderApproval=$("input[name='isLeader_Approval']:checked").val();
            var isStamp=$("input[name='is_Stamp']:checked").val();
            var theOtherParty=$("#theOtherParty").val();
            var theOtherPartyPhone=$("#theOtherPartyPhone").val();
            var contractNumber=$("#contractNumber").val();
            var contractSigningBasis=$("#contractSigningBasis").val();
            var contractMainThing=$("#contractMainThing").val();
            var contractTextNumber=$("#contractTextNumber").val();
            var ownContractTextNumber=$("#ownContractTextNumber").val();
            var otherContractTextNumber=$("#otherContractTextNumber").val();
            var contractOwner=$("#contractOwner").val();
            var contractOwnerPhone=$("#contractOwnerPhone").val();
            var contractOwnerDept=$("#contractOwnerDept").val();
            
            $("#getAnnexIds").val(annexIds);
            $("input[name='contractOwnerDept']").val(contractOwnerDept);
            $("input[name='contractOwnerPhone']").val(contractOwnerPhone);
            $("input[name='contractOwner']").val(contractOwner);
            $("input[name='contractName']").val(contractName);
            $("input[name='contractConfirmWay']").val(contractConfirmWay);
            $("input[name='contractMatter']").val(contractMatter);
            $("input[name='contractMoney']").val(contractMoney);
            $("input[name='isLeaderApproval']").val(isLeaderApproval);
            $("input[name='isStamp']").val(isStamp);
            $("input[name='theOtherParty']").val(theOtherParty);
            $("input[name='theOtherPartyPhone']").val(theOtherPartyPhone);
            $("input[name='contractNumber']").val(contractNumber);
            $("input[name='contractSigningBasis']").val(contractSigningBasis);
            $("input[name='contractMainThing']").val(contractMainThing);
            $("input[name='contractTextNumber']").val(contractTextNumber);
            $("input[name='ownContractTextNumber']").val(ownContractTextNumber);
            $("input[name='otherContractTextNumber']").val(otherContractTextNumber);
            $("input[name='isPromise']").val(1);
		}
		
	  	//保存、提交
	    function fnSubmitReport(isSubmit){
	  		
	    	if(isSubmit==1){
	  			$("#stateContract").val(0);
	  		}else{
	  			$("#stateContract").val(1);
	  		}
            var contractTextNumber=$("#contractTextNumber").val();
            var ownContractTextNumber=$("#ownContractTextNumber").val();
            var otherContractTextNumber=$("#otherContractTextNumber").val();
            var isPromise=$("#isPromise").val();
            var contractMoney=$("#contractMoney").val();
            var legal=$("input[name='legalAuditor']").val();//法务
            var accout=$("input[name='accoutingAuditor']").val();//会计
            //法务审核人-会计审核人
            if(legal==null||legal==""){
            	alert("请选择法务审核人!");
            	return
            }
            
            if(accout==null||accout==""){
            	alert("请选择会计审核人!");
            	return
            }
            //合同金额判断
            if(!(contractMoney==null||contractMoney=="")){
                var moneyTest=/^(([1-9]{1}\d*)|0)(\.\d{1,150})?$/;//金额正则
            	if(!(moneyTest.test(contractMoney))){
            		alert("请输入正确的合同金额！");
            		return;
            	}
            }
            
	  		//合同份数格式判断
	  			var numberTest = /^\+?[1-9]\d*$/;
		  		if(!numberTest.test(contractTextNumber)||!numberTest.test(ownContractTextNumber)||!numberTest.test(otherContractTextNumber)){
		  			 alert("请输入正确的合同份数！");
		  			 return
		  		}
	  		//是否承诺
	  		if(!$("#isPromiseState").is(":checked")){
	  			alert("请承诺！")
	  			return
	  		}
	  		
	  	
	  		//加载表单数据
	  		  loadForm();
	  		 $("#getAnnexIds").val(annexIds);
	  		  $.ajax({
					url:CTX+'contract/revise-contract',
					method:'post',
					data:$('#contractListFrom').serialize(),
					success:function(json){
						  alert('修改成功');
						  $("#contractListFrom").attr("action",CTX + 'contract/contract-enter');
					  	  $("#contractListFrom").submit();
					},
					error:function(){
						alert('请求超时或网络错误');
					}
				});
	  		
	  		 annexIds=[];
	    }
	  	
	  	//关闭合同签订界面返回主界面
	  	function fnClickReport(){
	  		$("#closeContractFrom").attr("action",CTX + 'contract/contract-enter');
	  		$("#closeContractFrom").submit();
	  	}
	  	
	  	//合同提交
		function contractSubmit(){
			//加载表单数据
		        var contractTextNumber=$("#contractTextNumber").val();
	            var ownContractTextNumber=$("#ownContractTextNumber").val();
	            var otherContractTextNumber=$("#otherContractTextNumber").val();
	            var isPromise=$("#isPromise").val();
	            var contractMoney=$("#contractMoney").val();
	            var legal=$("input[name='legalAuditor']").val();//法务
	            var accout=$("input[name='accoutingAuditor']").val();//会计
	            //法务审核人-会计审核人
	            if(legal==null||legal==""){
	            	alert("请选择法务审核人!");
	            	return
	            }
	            
	            if(accout==null||accout==""){
	            	alert("请选择会计审核人!");
	            	return
	            }
	            
	            //合同金额判断
	            if(!(contractMoney==null||contractMoney=="")){
	                var moneyTest=/^(([1-9]{1}\d*)|0)(\.\d{1,150})?$/;//金额正则
	            	if(!(moneyTest.test(contractMoney))){
	            		alert("请输入正确的合同金额！");
	            		return;
	            	}
	            }
	            
		  		//合同份数格式判断
		  			var numberTest = /^\+?[1-9]\d*$/;
			  		if(!numberTest.test(contractTextNumber)||!numberTest.test(ownContractTextNumber)||!numberTest.test(otherContractTextNumber)){
			  			 alert("请输入正确的合同份数！");
			  			 return
			  		}
		  		//是否承诺
		  		if(!$("#isPromiseState").is(":checked")){
		  			alert("请承诺！")
		  			return
		  		}
		  		
			$("input[name='annexIds']").val(annexIds);
			$("#contractSubmit").attr("disabled",true);
	  		loadForm();
			$.ajax({
				url:CTX+'contract-approve/submit-contract',
				method:'post',
				data:$('#contractListFrom').serialize(),
				success:function(json){
					alert('成功提交');
					window.open(CTX+'contract/contract-enter',"_self")
				},
				error:function(){
					alert('请求超时或网络错误');
				}
			});
			 annexIds=[];
		}
	  	
	  	
		/*]]>*/
	</script>

	</html>

